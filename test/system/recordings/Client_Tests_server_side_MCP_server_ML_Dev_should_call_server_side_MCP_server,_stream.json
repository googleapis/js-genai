{
  "recordID": "Client_Tests_server_side_MCP_server_ML_Dev_should_call_server_side_MCP_server,_stream",
  "interactions": [
    {
      "request": {
        "method": "POST",
        "url": "/v1beta/models/gemini-2.5-flash:streamGenerateContent?alt=sse",
        "request": "POST /v1beta/models/gemini-2.5-flash:streamGenerateContent?alt=sse HTTP/1.1",
        "headers": {
          "Accept": "*/*",
          "Accept-Encoding": "gzip, deflate",
          "Accept-Language": "*",
          "Connection": "keep-alive",
          "Content-Length": "329",
          "Content-Type": "application/json",
          "Sec-Fetch-Mode": "cors",
          "Test-Name": "Client Tests server side MCP server ML Dev should call server side MCP server, stream"
        },
        "bodySegments": [
          {
            "contents": [
              {
                "parts": [
                  {
                    "text": "What is the weather like in New York ON 02/02/2026?"
                  }
                ],
                "role": "user"
              }
            ],
            "generationConfig": {},
            "tools": [
              {
                "mcpServers": [
                  {
                    "name": "weather_server",
                    "streamableHttpTransport": {
                      "headers": {
                        "AUTHORIZATION": "Bearer github_pat_XXXX"
                      },
                      "timeout": "10s",
                      "url": "https://gemini-api-demos.uc.r.appspot.com/mcp"
                    }
                  }
                ]
              }
            ]
          }
        ],
        "previousRequest": "b4d6e60a9b97e7b98c63df9308728c5c88c0b40c398046772c63447b94608b4d",
        "serverAddress": "generativelanguage.googleapis.com",
        "port": 443,
        "protocol": "https"
      },
      "shaSum": "be78997e9567ae25c053782496533ef03aba7fe301c3735a84c8d8cad1810a69",
      "response": {
        "statusCode": 200,
        "headers": {
          "Content-Disposition": "attachment",
          "Content-Type": "text/event-stream",
          "Date": "Mon, 16 Feb 2026 00:43:44 GMT",
          "Server": "scaffolding on HTTPServer2",
          "Server-Timing": "gfet4t7; dur=1358",
          "Vary": "Origin, X-Origin, Referer",
          "X-Content-Type-Options": "nosniff",
          "X-Frame-Options": "SAMEORIGIN",
          "X-Xss-Protection": "0"
        },
        "bodySegments": [
          {
            "candidates": [
              {
                "content": {
                  "parts": [
                    {
                      "functionCall": {
                        "args": {
                          "endDate": "2026-02-02",
                          "location": "New York",
                          "startDate": "2026-02-02"
                        },
                        "name": "weather_server_get_weather"
                      }
                    }
                  ],
                  "role": "model"
                },
                "finishMessage": "Model generated function call(s).",
                "finishReason": "STOP",
                "index": 0
              }
            ],
            "modelVersion": "gemini-2.5-flash",
            "responseId": "QGiSafzoFOuRjrEPw4nssAI",
            "turnToken": "v1_ChdRR2lTYWZ6b0ZPdVJqckVQdzRuc3NBSRIXUUdpU2Fmem9GT3VSanJFUHc0bnNzQUk",
            "usageMetadata": {
              "candidatesTokenCount": 48,
              "promptTokenCount": 22,
              "promptTokensDetails": [
                {
                  "modality": "TEXT",
                  "tokenCount": 22
                }
              ],
              "thoughtsTokenCount": 102,
              "totalTokenCount": 172
            }
          },
          {
            "candidates": [
              {
                "content": {
                  "parts": [
                    {
                      "functionResponse": {
                        "name": "weather_server_get_weather",
                        "response": {
                          "call_tool_result_json": "{\"meta\":null,\"content\":[{\"type\":\"text\",\"text\":\"{\\\"2026-02-02T00:00\\\":\\\"-8.4°C\\\",\\\"2026-02-02T01:00\\\":\\\"-9.2°C\\\",\\\"2026-02-02T02:00\\\":\\\"-9.8°C\\\",\\\"2026-02-02T03:00\\\":\\\"-10.6°C\\\",\\\"2026-02-02T04:00\\\":\\\"-11.1°C\\\",\\\"2026-02-02T05:00\\\":\\\"-11.2°C\\\",\\\"2026-02-02T06:00\\\":\\\"-10.8°C\\\",\\\"2026-02-02T07:00\\\":\\\"-11.4°C\\\",\\\"2026-02-02T08:00\\\":\\\"-13°C\\\",\\\"2026-02-02T09:00\\\":\\\"-12.4°C\\\",\\\"2026-02-02T10:00\\\":\\\"-11.5°C\\\",\\\"2026-02-02T11:00\\\":\\\"-12.4°C\\\",\\\"2026-02-02T12:00\\\":\\\"-11°C\\\",\\\"2026-02-02T13:00\\\":\\\"-10.6°C\\\",\\\"2026-02-02T14:00\\\":\\\"-7.6°C\\\",\\\"2026-02-02T15:00\\\":\\\"-4.8°C\\\",\\\"2026-02-02T16:00\\\":\\\"-2.7°C\\\",\\\"2026-02-02T17:00\\\":\\\"-1.3°C\\\",\\\"2026-02-02T18:00\\\":\\\"-0.2°C\\\",\\\"2026-02-02T19:00\\\":\\\"0.9°C\\\",\\\"2026-02-02T20:00\\\":\\\"0.6°C\\\",\\\"2026-02-02T21:00\\\":\\\"0.5°C\\\",\\\"2026-02-02T22:00\\\":\\\"-0.4°C\\\",\\\"2026-02-02T23:00\\\":\\\"-2°C\\\"}\",\"annotations\":null,\"meta\":null}],\"structuredContent\":null,\"isError\":false}",
                          "result": "{\"2026-02-02T00:00\":\"-8.4°C\",\"2026-02-02T01:00\":\"-9.2°C\",\"2026-02-02T02:00\":\"-9.8°C\",\"2026-02-02T03:00\":\"-10.6°C\",\"2026-02-02T04:00\":\"-11.1°C\",\"2026-02-02T05:00\":\"-11.2°C\",\"2026-02-02T06:00\":\"-10.8°C\",\"2026-02-02T07:00\":\"-11.4°C\",\"2026-02-02T08:00\":\"-13°C\",\"2026-02-02T09:00\":\"-12.4°C\",\"2026-02-02T10:00\":\"-11.5°C\",\"2026-02-02T11:00\":\"-12.4°C\",\"2026-02-02T12:00\":\"-11°C\",\"2026-02-02T13:00\":\"-10.6°C\",\"2026-02-02T14:00\":\"-7.6°C\",\"2026-02-02T15:00\":\"-4.8°C\",\"2026-02-02T16:00\":\"-2.7°C\",\"2026-02-02T17:00\":\"-1.3°C\",\"2026-02-02T18:00\":\"-0.2°C\",\"2026-02-02T19:00\":\"0.9°C\",\"2026-02-02T20:00\":\"0.6°C\",\"2026-02-02T21:00\":\"0.5°C\",\"2026-02-02T22:00\":\"-0.4°C\",\"2026-02-02T23:00\":\"-2°C\"}"
                        }
                      }
                    }
                  ],
                  "role": "model"
                },
                "index": 0
              }
            ],
            "modelVersion": "gemini-2.5-flash",
            "responseId": "QGiSafzoFOuRjrEPw4nssAI",
            "turnToken": "v1_ChdRR2lTYWZ6b0ZPdVJqckVQdzRuc3NBSRIXUUdpU2Fmem9GT3VSanJFUHc0bnNzQUk",
            "usageMetadata": {
              "candidatesTokenCount": 48,
              "promptTokenCount": 22,
              "promptTokensDetails": [
                {
                  "modality": "TEXT",
                  "tokenCount": 22
                }
              ],
              "thoughtsTokenCount": 102,
              "totalTokenCount": 172
            }
          },
          {
            "candidates": [
              {
                "content": {
                  "parts": [
                    {
                      "text": "On February 2nd, 2026, the weather in New York will range from a low of -13"
                    }
                  ],
                  "role": "model"
                },
                "index": 0
              }
            ],
            "modelVersion": "gemini-2.5-flash",
            "responseId": "QGiSafzoFOuRjrEPw4nssAI",
            "turnToken": "v1_ChdRR2lTYWZ6b0ZPdVJqckVQdzRuc3NBSRIXUUdpU2Fmem9GT3VSanJFUHc0bnNzQUk",
            "usageMetadata": {
              "candidatesTokenCount": 74,
              "promptTokenCount": 22,
              "promptTokensDetails": [
                {
                  "modality": "TEXT",
                  "tokenCount": 22
                }
              ],
              "thoughtsTokenCount": 573,
              "toolUsePromptTokenCount": 124,
              "toolUsePromptTokensDetails": [
                {
                  "modality": "TEXT",
                  "tokenCount": 124
                }
              ],
              "totalTokenCount": 793
            }
          },
          {
            "candidates": [
              {
                "content": {
                  "parts": [
                    {
                      "text": "°C at 8:00 AM to a high of 0.9°C at 7:00 PM."
                    }
                  ],
                  "role": "model"
                },
                "finishReason": "STOP",
                "index": 0
              }
            ],
            "modelVersion": "gemini-2.5-flash",
            "responseId": "QGiSafzoFOuRjrEPw4nssAI",
            "turnToken": "v1_ChdRR2lTYWZ6b0ZPdVJqckVQdzRuc3NBSRIXUUdpU2Fmem9GT3VSanJFUHc0bnNzQUk",
            "usageMetadata": {
              "candidatesTokenCount": 101,
              "promptTokenCount": 22,
              "promptTokensDetails": [
                {
                  "modality": "TEXT",
                  "tokenCount": 22
                }
              ],
              "thoughtsTokenCount": 573,
              "toolUsePromptTokenCount": 124,
              "toolUsePromptTokensDetails": [
                {
                  "modality": "TEXT",
                  "tokenCount": 124
                }
              ],
              "totalTokenCount": 820
            }
          }
        ]
      }
    }
  ]
}
