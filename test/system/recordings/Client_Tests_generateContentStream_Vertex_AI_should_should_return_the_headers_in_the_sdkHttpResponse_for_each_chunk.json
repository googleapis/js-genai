{
  "recordID": "Client_Tests_generateContentStream_Vertex_AI_should_should_return_the_headers_in_the_sdkHttpResponse_for_each_chunk",
  "interactions": [
    {
      "request": {
        "method": "POST",
        "url": "/v1beta1/projects/REDACTED/locations/REDACTED/publishers/google/models/gemini-1.5-flash:streamGenerateContent?alt=sse",
        "request": "POST /v1beta1/projects/REDACTED/locations/REDACTED/publishers/google/models/gemini-1.5-flash:streamGenerateContent?alt=sse HTTP/1.1",
        "headers": {
          "Accept": "*/*",
          "Accept-Encoding": "gzip, deflate",
          "Accept-Language": "*",
          "Connection": "keep-alive",
          "Content-Length": "134",
          "Content-Type": "application/json",
          "Sec-Fetch-Mode": "cors",
          "Test-Name": "Client Tests generateContentStream Vertex AI should should return the headers in the sdkHttpResponse for each chunk"
        },
        "bodySegments": [
          {
            "contents": [
              {
                "parts": [
                  {
                    "text": "why is the sky blue?"
                  }
                ],
                "role": "user"
              }
            ],
            "generationConfig": {
              "candidateCount": 1,
              "maxOutputTokens": 200
            }
          }
        ],
        "previousRequest": "b4d6e60a9b97e7b98c63df9308728c5c88c0b40c398046772c63447b94608b4d",
        "serverAddress": "us-central1-aiplatform.googleapis.com",
        "port": 443,
        "protocol": "https"
      },
      "shaSum": "a5835370cc10a4ffa2028c82606d552c24a0a45b27c7df4f41444e36c0e3d12e",
      "response": {
        "statusCode": 200,
        "headers": {
          "Content-Disposition": "attachment",
          "Content-Type": "text/event-stream",
          "Date": "Sat, 16 Aug 2025 00:42:59 GMT",
          "Server": "scaffolding on HTTPServer2",
          "Vary": "Origin, X-Origin, Referer",
          "X-Content-Type-Options": "nosniff",
          "X-Frame-Options": "SAMEORIGIN",
          "X-Xss-Protection": "0"
        },
        "bodySegments": [
          {
            "candidates": [
              {
                "content": {
                  "parts": [
                    {
                      "text": "The"
                    }
                  ],
                  "role": "model"
                }
              }
            ],
            "createTime": "2025-08-16T00:42:59.271732Z",
            "modelVersion": "gemini-1.5-flash-002",
            "responseId": "E9SfaPTKEIibm9IP-c-U6Qw",
            "usageMetadata": {
              "billablePromptUsage": {
                "textCount": 16
              },
              "trafficType": "ON_DEMAND"
            }
          },
          {
            "candidates": [
              {
                "content": {
                  "parts": [
                    {
                      "text": " sky is blue due to a phenomenon called **Rayleigh scattering**.  Sunlight is"
                    }
                  ],
                  "role": "model"
                }
              }
            ],
            "createTime": "2025-08-16T00:42:59.271732Z",
            "modelVersion": "gemini-1.5-flash-002",
            "responseId": "E9SfaPTKEIibm9IP-c-U6Qw",
            "usageMetadata": {
              "trafficType": "ON_DEMAND"
            }
          },
          {
            "candidates": [
              {
                "content": {
                  "parts": [
                    {
                      "text": " made up of all the colors of the rainbow.  As sunlight enters the Earth"
                    }
                  ],
                  "role": "model"
                }
              }
            ],
            "createTime": "2025-08-16T00:42:59.271732Z",
            "modelVersion": "gemini-1.5-flash-002",
            "responseId": "E9SfaPTKEIibm9IP-c-U6Qw",
            "usageMetadata": {
              "trafficType": "ON_DEMAND"
            }
          },
          {
            "candidates": [
              {
                "content": {
                  "parts": [
                    {
                      "text": "'s atmosphere, it collides with tiny air molecules (mostly nitrogen and oxygen).  These molecules are much smaller than the wavelengths of visible light.\n\nRay"
                    }
                  ],
                  "role": "model"
                }
              }
            ],
            "createTime": "2025-08-16T00:42:59.271732Z",
            "modelVersion": "gemini-1.5-flash-002",
            "responseId": "E9SfaPTKEIibm9IP-c-U6Qw",
            "usageMetadata": {
              "trafficType": "ON_DEMAND"
            }
          },
          {
            "candidates": [
              {
                "content": {
                  "parts": [
                    {
                      "text": "leigh scattering affects shorter wavelengths of light more strongly than longer wavelengths.  Blue and violet light have the shortest wavelengths, so they are scattered much more than other colors"
                    }
                  ],
                  "role": "model"
                }
              }
            ],
            "createTime": "2025-08-16T00:42:59.271732Z",
            "modelVersion": "gemini-1.5-flash-002",
            "responseId": "E9SfaPTKEIibm9IP-c-U6Qw",
            "usageMetadata": {
              "trafficType": "ON_DEMAND"
            }
          },
          {
            "candidates": [
              {
                "content": {
                  "parts": [
                    {
                      "text": ".  This scattered blue light is what we see when we look at the sky.\n\nWhile violet light is scattered even more than blue, our eyes are less sensitive to violet, and the sun emits slightly less violet light, resulting in a"
                    }
                  ],
                  "role": "model"
                }
              }
            ],
            "createTime": "2025-08-16T00:42:59.271732Z",
            "modelVersion": "gemini-1.5-flash-002",
            "responseId": "E9SfaPTKEIibm9IP-c-U6Qw",
            "usageMetadata": {
              "trafficType": "ON_DEMAND"
            }
          },
          {
            "candidates": [
              {
                "content": {
                  "parts": [
                    {
                      "text": " blue sky rather than a violet one.\n"
                    }
                  ],
                  "role": "model"
                },
                "finishReason": "STOP"
              }
            ],
            "createTime": "2025-08-16T00:42:59.271732Z",
            "modelVersion": "gemini-1.5-flash-002",
            "responseId": "E9SfaPTKEIibm9IP-c-U6Qw",
            "usageMetadata": {
              "candidatesTokenCount": 154,
              "candidatesTokensDetails": [
                {
                  "modality": "TEXT",
                  "tokenCount": 154
                }
              ],
              "promptTokenCount": 6,
              "promptTokensDetails": [
                {
                  "modality": "TEXT",
                  "tokenCount": 6
                }
              ],
              "totalTokenCount": 160,
              "trafficType": "ON_DEMAND"
            }
          }
        ]
      }
    }
  ]
}
