{
  "recordID": "Client_Tests_generateContent_Vertex_AI_should_generate_content_with_given_valid_json_schema_in_responseJsonSchema",
  "interactions": [
    {
      "request": {
        "method": "POST",
        "url": "/v1beta1/projects/REDACTED/locations/REDACTED/publishers/google/models/gemini-2.5-flash:generateContent",
        "request": "POST /v1beta1/projects/REDACTED/locations/REDACTED/publishers/google/models/gemini-2.5-flash:generateContent HTTP/1.1",
        "headers": {
          "Accept": "*/*",
          "Accept-Encoding": "gzip, deflate",
          "Accept-Language": "*",
          "Connection": "keep-alive",
          "Content-Length": "1597",
          "Content-Type": "application/json",
          "Sec-Fetch-Mode": "cors",
          "Test-Name": "Client Tests generateContent Vertex AI should generate content with given valid json schema in responseJsonSchema"
        },
        "bodySegments": [
          {
            "contents": [
              {
                "parts": [
                  {
                    "text": "populate the following object"
                  }
                ],
                "role": "user"
              }
            ],
            "generationConfig": {
              "responseJsonSchema": {
                "$schema": "http://json-schema.org/draft-07/schema#",
                "additionalProperties": false,
                "properties": {
                  "arrayFiled": {
                    "items": {
                      "type": "string"
                    },
                    "type": "array"
                  },
                  "inner": {
                    "additionalProperties": false,
                    "properties": {
                      "innerNumber": {
                        "type": "number"
                      },
                      "innerString": {
                        "type": "string"
                      }
                    },
                    "required": ["innerString", "innerNumber"],
                    "type": "object"
                  },
                  "integerInt64": {
                    "type": "integer"
                  },
                  "nullableArrayField": {
                    "anyOf": [
                      {
                        "items": {
                          "type": "string"
                        },
                        "type": "array"
                      },
                      {
                        "type": "null"
                      }
                    ]
                  },
                  "nullableField": {
                    "type": ["string", "null"]
                  },
                  "nullableObjectField": {
                    "anyOf": [
                      {
                        "additionalProperties": false,
                        "properties": {
                          "innerNumber": {
                            "type": "number"
                          },
                          "innerString": {
                            "type": "string"
                          }
                        },
                        "required": ["innerString", "innerNumber"],
                        "type": "object"
                      },
                      {
                        "type": "null"
                      }
                    ]
                  },
                  "numberWithMinMax": {
                    "maximum": 10,
                    "minimum": 1,
                    "type": "number"
                  },
                  "simpleBoolean": {
                    "type": "boolean"
                  },
                  "simpleInteger": {
                    "type": "integer"
                  },
                  "simpleNumber": {
                    "type": "number"
                  },
                  "simpleString": {
                    "default": "default",
                    "type": "string"
                  },
                  "stringDatetime": {
                    "format": "date-time",
                    "type": "string"
                  },
                  "stringWithEnum": {
                    "enum": ["enumvalue1", "enumvalue2", "enumvalue3"],
                    "type": "string"
                  },
                  "stringWithLength": {
                    "maxLength": 10,
                    "minLength": 1,
                    "type": "string"
                  },
                  "unionField": {
                    "type": ["string", "number"]
                  }
                },
                "required": [
                  "stringDatetime",
                  "stringWithEnum",
                  "stringWithLength",
                  "simpleNumber",
                  "simpleInteger",
                  "integerInt64",
                  "numberWithMinMax",
                  "simpleBoolean",
                  "arrayFiled",
                  "unionField",
                  "nullableField",
                  "nullableArrayField",
                  "nullableObjectField",
                  "inner"
                ],
                "type": "object"
              },
              "responseMimeType": "application/json"
            }
          }
        ],
        "previousRequest": "b4d6e60a9b97e7b98c63df9308728c5c88c0b40c398046772c63447b94608b4d",
        "serverAddress": "us-central1-aiplatform.googleapis.com",
        "port": 443,
        "protocol": "https"
      },
      "shaSum": "96b7ea4d6b858546fb4d47aa89ab48916cd3208359e804a69f5b18003cb8b9a6",
      "response": {
        "statusCode": 200,
        "headers": {
          "Content-Encoding": "gzip",
          "Content-Length": "697",
          "Content-Type": "application/json; charset=UTF-8",
          "Date": "Fri, 24 Oct 2025 07:45:26 GMT",
          "Server": "scaffolding on HTTPServer2",
          "Vary": "Origin, X-Origin, Referer",
          "X-Content-Type-Options": "nosniff",
          "X-Frame-Options": "SAMEORIGIN",
          "X-Xss-Protection": "0"
        },
        "bodySegments": [
          {
            "candidates": [
              {
                "avgLogprobs": -0.4038639962673187,
                "content": {
                  "parts": [
                    {
                      "text": "{\n  \"stringDatetime\": \"2023-10-27T10:00:00Z\",\n  \"stringWithEnum\": \"enumvalue1\",\n  \"stringWithLength\": \"test\",\n  \"simpleNumber\": 123.45,\n  \"simpleInteger\": 42,\n  \"integerInt64\": 9876543210,\n  \"numberWithMinMax\": 5.5,\n  \"simpleBoolean\": true,\n  \"arrayFiled\": [\n    \"item1\",\n    \"item2\"\n  ],\n  \"unionField\": \"unionStringValue\",\n  \"nullableField\": \"notNullString\",\n  \"nullableArrayField\": [\n    \"arrayItem1\",\n    \"arrayItem2\"\n  ],\n  \"nullableObjectField\": {\n    \"innerString\": \"nullableInnerString\",\n    \"innerNumber\": 789\n  },\n  \"inner\": {\n    \"innerString\": \"someString\",\n    \"innerNumber\": 101\n  },\n  \"simpleString\": \"anotherSimpleString\"\n}"
                    }
                  ],
                  "role": "model"
                },
                "finishReason": "STOP",
                "score": -103.3891830444336
              }
            ],
            "createTime": "2025-10-24T07:45:21.133030Z",
            "modelVersion": "gemini-2.5-flash",
            "responseId": "kS77aKaPCK2g3NoPg96PgAY",
            "usageMetadata": {
              "billablePromptUsage": {
                "textCount": 1061
              },
              "candidatesTokenCount": 256,
              "candidatesTokensDetails": [
                {
                  "modality": "TEXT",
                  "tokenCount": 256
                }
              ],
              "promptTokenCount": 4,
              "promptTokensDetails": [
                {
                  "modality": "TEXT",
                  "tokenCount": 4
                }
              ],
              "thoughtsTokenCount": 646,
              "totalTokenCount": 906,
              "trafficType": "ON_DEMAND"
            }
          }
        ]
      }
    }
  ]
}
